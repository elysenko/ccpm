# PRD Template Schema

## Overview

This template defines the structure for PRDs generated by the decomposition algorithm. It is designed to be machine-parseable while remaining human-readable.

---

## YAML Schema

```yaml
# PRD Schema v1.0
prd:
  # Required fields
  id: string                    # Unique identifier (e.g., "PRD-AUTH-001")
  title: string                 # Short descriptive title (< 80 chars)
  status: enum                  # draft | review | approved | in-progress | done
  created: datetime             # ISO 8601 timestamp
  updated: datetime             # ISO 8601 timestamp

  # Core content
  user_story:
    role: string                # The user type
    goal: string                # What they want to do
    benefit: string             # Why they want to do it

  description: string           # Detailed description (markdown supported)

  acceptance_criteria:          # List of testable criteria
    - criterion: string
      type: enum                # functional | performance | security | ux
      testable: boolean         # Is this objectively testable?

  # Dependencies
  dependencies:
    - prd_id: string            # ID of dependent PRD
      type: enum                # blocks | informs | related
      description: string       # Brief explanation

  # Sizing
  size:
    estimate: enum              # XS | S | M | L | XL
    confidence: enum            # high | medium | low
    basis: string               # How estimate was derived

  # Quality scores
  invest_score:
    independent: float          # 0.0 - 1.0
    negotiable: float           # 0.0 - 1.0
    valuable: float             # 0.0 - 1.0
    estimable: float            # 0.0 - 1.0
    small: float                # 0.0 - 1.0
    testable: float             # 0.0 - 1.0
    composite: float            # Weighted average

  # Metadata
  tags: list[string]            # Categorization tags
  domain: string                # Business domain
  epic_id: string               # Parent epic/roadmap item
  generated_by: string          # Agent/process that created this
  review_required: boolean      # Needs human review?
  review_notes: string          # Notes from review
```

---

## Markdown Template

```markdown
---
id: PRD-{EPIC}-{NUM}
title: {Title}
status: draft
created: {ISO_DATETIME}
updated: {ISO_DATETIME}
epic: {PARENT_EPIC_ID}
size: {XS|S|M|L|XL}
tags: [{tag1}, {tag2}]
invest_composite: {0.00}
review_required: {true|false}
---

# {Title}

## User Story

**As a** {user role},
**I want** {goal/capability},
**So that** {benefit/value}.

## Description

{Detailed description of what this PRD delivers. Should explain:
- The problem being solved
- The proposed solution approach
- Key constraints or considerations
- Out of scope items}

## Acceptance Criteria

1. **[FUNCTIONAL]** {Criterion 1}
   - Given {precondition}
   - When {action}
   - Then {expected result}

2. **[FUNCTIONAL]** {Criterion 2}
   - Given {precondition}
   - When {action}
   - Then {expected result}

3. **[PERFORMANCE]** {Criterion 3}
   - {Measurable performance requirement}

4. **[SECURITY]** {Criterion 4}
   - {Security requirement if applicable}

5. **[UX]** {Criterion 5}
   - {User experience requirement if applicable}

## Dependencies

| PRD ID | Type | Description |
|--------|------|-------------|
| {PRD-XXX-001} | blocks | {Why this PRD must complete first} |
| {PRD-XXX-002} | informs | {How this PRD provides context} |

## Technical Considerations

{Any technical notes relevant to implementation. Keep high-level, avoid prescribing solutions.}

## Out of Scope

- {Item 1 explicitly excluded}
- {Item 2 explicitly excluded}

## Size Estimate

- **Estimate:** {XS|S|M|L|XL}
- **Confidence:** {high|medium|low}
- **Basis:** {How estimate was derived}

## INVEST Score

| Criterion | Score | Notes |
|-----------|-------|-------|
| Independent | {0.00} | {Brief note} |
| Negotiable | {0.00} | {Brief note} |
| Valuable | {0.00} | {Brief note} |
| Estimable | {0.00} | {Brief note} |
| Small | {0.00} | {Brief note} |
| Testable | {0.00} | {Brief note} |
| **Composite** | **{0.00}** | |

## Review Notes

{Notes from human review, if any}

---
*Generated by pm:decompose on {ISO_DATETIME}*
```

---

## Size Definitions

| Size | Typical Duration | Complexity | Acceptance Criteria |
|------|-----------------|------------|---------------------|
| **XS** | 1-2 days | Single component, well-understood | 2-3 criteria |
| **S** | 3-5 days | Few components, some unknowns | 3-5 criteria |
| **M** | 1-2 weeks | Multiple components, moderate complexity | 5-7 criteria |
| **L** | 2-3 weeks | Many components, high complexity | 7-10 criteria |
| **XL** | 3+ weeks | Consider splitting further | 10+ criteria |

**Note:** XL typically indicates the PRD should be decomposed further.

---

## Acceptance Criteria Guidelines

### Types

| Type | Symbol | Description |
|------|--------|-------------|
| Functional | [F] | What the system does |
| Performance | [P] | How fast/efficient |
| Security | [S] | Protection requirements |
| UX | [U] | User experience quality |
| Accessibility | [A] | Accessibility requirements |

### Structure (Given-When-Then)

```
Given [precondition/context]
When [action/trigger]
Then [expected outcome]
And [additional outcomes if any]
```

### Quality Checks

Good acceptance criteria are:
- ✅ Testable (clear pass/fail)
- ✅ Specific (no ambiguity)
- ✅ Complete (no hidden assumptions)
- ✅ Independent (testable in isolation)

Bad acceptance criteria are:
- ❌ Vague ("works well", "fast enough")
- ❌ Implementation-specific ("uses Redis")
- ❌ Dependent on other stories
- ❌ Too broad (multiple features in one)

---

## Dependency Types

| Type | Direction | Meaning |
|------|-----------|---------|
| **blocks** | Hard | Cannot start until dependency completes |
| **informs** | Soft | Benefits from dependency but not blocked |
| **related** | Reference | Related but independent |

### When to Use Each

**Blocks:**
- Dependency creates data/API that this PRD consumes
- Dependency establishes infrastructure this PRD requires
- Dependency implements auth that this PRD needs

**Informs:**
- Dependency provides patterns to follow
- Dependency clarifies requirements for this PRD
- Dependency may affect design decisions

**Related:**
- PRDs touch same domain but don't depend
- PRDs may have integration points later
- Documentation purposes

---

## Example PRD

```markdown
---
id: PRD-AUTH-001
title: Email/Password User Registration
status: draft
created: 2026-01-20T12:00:00Z
updated: 2026-01-20T12:00:00Z
epic: EPIC-AUTH
size: M
tags: [authentication, registration, mvp]
invest_composite: 0.82
review_required: false
---

# Email/Password User Registration

## User Story

**As a** new visitor,
**I want** to create an account using my email and password,
**So that** I can access personalized features and save my preferences.

## Description

This PRD covers the core registration flow for new users using email and password authentication. It includes the registration form, input validation, account creation, and initial email verification.

This is the MVP authentication method that enables all subsequent account-based features. Social login methods will be added in separate PRDs.

## Acceptance Criteria

1. **[FUNCTIONAL]** User can access registration form
   - Given I am on the homepage
   - When I click "Sign Up"
   - Then I see a registration form with email, password, and confirm password fields

2. **[FUNCTIONAL]** Email validation
   - Given I am on the registration form
   - When I enter an invalid email format
   - Then I see an inline error message "Please enter a valid email"
   - And the form does not submit

3. **[FUNCTIONAL]** Password requirements
   - Given I am on the registration form
   - When I enter a password shorter than 8 characters
   - Then I see an error "Password must be at least 8 characters"
   - When I enter a password without a number
   - Then I see an error "Password must contain at least one number"

4. **[FUNCTIONAL]** Successful registration
   - Given I enter valid email and matching passwords
   - When I click "Create Account"
   - Then my account is created
   - And I receive a verification email
   - And I am redirected to a "verify your email" page

5. **[FUNCTIONAL]** Duplicate email handling
   - Given an account already exists with email "test@example.com"
   - When I try to register with "test@example.com"
   - Then I see "An account with this email already exists"
   - And I am offered a link to the login page

6. **[SECURITY]** Password storage
   - Given a user registers successfully
   - Then the password is stored using bcrypt with cost factor >= 10
   - And the plain text password is never logged or stored

7. **[PERFORMANCE]** Registration response time
   - Given valid registration data
   - When I submit the form
   - Then the response completes within 2 seconds

## Dependencies

| PRD ID | Type | Description |
|--------|------|-------------|
| None | - | This is a foundational PRD |

## Technical Considerations

- Email delivery should be asynchronous to not block registration response
- Consider rate limiting to prevent registration spam
- Verification tokens should expire after 24 hours

## Out of Scope

- Social login (Google, GitHub) - see PRD-AUTH-002
- Two-factor authentication - see PRD-AUTH-004
- Password reset flow - see PRD-AUTH-003
- Remember me functionality

## Size Estimate

- **Estimate:** M
- **Confidence:** high
- **Basis:** Well-understood pattern, similar to previous implementations

## INVEST Score

| Criterion | Score | Notes |
|-----------|-------|-------|
| Independent | 0.95 | No dependencies, enables other PRDs |
| Negotiable | 0.70 | Some flexibility in UX details |
| Valuable | 0.90 | Core feature for product |
| Estimable | 0.85 | Clear scope, familiar pattern |
| Small | 0.75 | M-sized, could split but not necessary |
| Testable | 0.90 | Clear acceptance criteria |
| **Composite** | **0.82** | |

## Review Notes

_No review notes yet_

---
*Generated by pm:decompose on 2026-01-20T12:00:00Z*
```
